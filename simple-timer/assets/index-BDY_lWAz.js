(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const i of e)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(e){const i={};return e.integrity&&(i.integrity=e.integrity),e.referrerPolicy&&(i.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?i.credentials="include":e.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(e){if(e.ep)return;e.ep=!0;const i=s(e);fetch(e.href,i)}})();class a{static secondsToFormattedTime(t){const s=Math.floor(t/3600),r=Math.floor(t%3600/60),e=t%60,i=o=>o.toString().padStart(2,"0");return`${i(s)}:${i(r)}:${i(e)}`}static secondsToTime(t){const s=Math.floor(t/3600),r=t%3600,e=Math.floor(r/60),i=r%60;return{hours:s,minutes:e,seconds:i}}static formatTime(t,s=!1,r){const e=new Date(0),i=s?20+r:19;return e.setMilliseconds(t*1e3),e.toISOString().substring(11,i)}}class l{tickMs;second=1e3;timerNode;options;timerInterval;timerSeconds;timerState;initialized=!1;directionFlag=!0;config={fewAttr:"data-few",storageKey:"la5yPNRGnSn7tnK"};listeners={stop:[],play:[],pause:[],reset:[]};constructor(t,s){if(!t)throw new Error("Invalid selector");const r=document.querySelector(t);if(!r)throw new Error("Invalid timer node");this.timerSeconds=0,this.timerInterval=0,this.timerState="stop",this.timerNode=r;const i={...{seconds:900,few:null,fewColor:"red",setFewColor:!1,bounce:!1,redirect:!1,redirectUrl:null,saveStateInStorage:!1,displayMilliseconds:!1,fractionDigits:1,autoPlay:!0},...s};i.fractionDigits>3&&(i.fractionDigits=3),i.fractionDigits<0&&(i.fractionDigits=1),i.fractionDigits<1&&(i.displayMilliseconds=!1),this.options=this.validateOptions(i),this.tickMs=this.options.displayMilliseconds?this.second/10**this.options.fractionDigits:this.second,this.drawPlaceholder()}getState(){return this.timerState}pause(){if(["pause","stop"].includes(this.timerState)){window.alert("Таймер уже был остановлен.");return}clearTimeout(this.timerInterval),this.setStateAndNotifyListeners("pause")}play(){if(this.timerState!=="pause"){this.timerState!=="play"&&window.alert("Невозможно восстановить таймер.");return}clearTimeout(this.timerInterval),this.playTimer(),this.notifyListeners("play")}stop(){if(this.timerState==="stop"){window.alert("Таймер уже был остановлен.");return}clearTimeout(this.timerInterval),this.timerSeconds=0,this.drawTimer(),this.setStateAndNotifyListeners("stop")}reset(){const{seconds:t,autoPlay:s}=this.options;clearTimeout(this.timerInterval),this.timerSeconds=t,s?(this.playTimer(),this.notifyListeners("reset")):(this.drawTimer(),this.setStateAndNotifyListeners("pause"))}initialize(){if(this.initialized)throw new Error("Invalid initialization");const{seconds:t,autoPlay:s,saveStateInStorage:r}=this.options;if(this.timerSeconds=t,r&&"localStorage"in window){const e=window.localStorage.getItem(this.config.storageKey);e&&+e>=0&&(this.timerSeconds=+e)}s?(this.playTimer(),this.notifyListeners("play")):(this.drawTimer(),this.setStateAndNotifyListeners("pause")),this.initialized=!0}onStop(t){this.listeners.stop=[t]}onPause(t){this.listeners.pause=[t]}onPlay(t){this.listeners.play=[t]}onReset(t){this.listeners.reset=[t]}addEventListener(t,s){this.listeners[t].push(s)}notifyListeners(t){for(const s of this.listeners[t])s()}setStateAndNotifyListeners(t){this.timerState=t,this.notifyListeners(t)}playTimer(){this.drawTimer(),this.timerSeconds&&(this.timerState="play",this.timerInterval=setInterval(this.intervalTick.bind(this),this.tickMs))}intervalTick(){this.directionFlag?this.timerSeconds-=this.tickMs/this.second:this.timerSeconds+=this.tickMs/this.second,this.timerSeconds=+this.timerSeconds.toFixed(this.options.fractionDigits),this.drawTimer(),!this.options.bounce&&this.timerSeconds<=0&&(clearInterval(this.timerInterval),this.setStateAndNotifyListeners("stop"),this.options.redirect&&this.options.redirectUrl&&setTimeout(()=>{window.location.href=this.options.redirectUrl},this.second));const t=this.timerSeconds===0,s=this.timerSeconds>=this.options.seconds;(this.options.bounce&&t||s)&&(this.directionFlag=!this.directionFlag)}formatTime(t){return a.formatTime(t,this.options.displayMilliseconds,this.options.fractionDigits)}drawTimer(){if(this.timerNode.innerText=this.formatTime(this.timerSeconds),this.options.few!==null){const t=this.timerSeconds<=this.options.few,s=this.timerNode.hasAttribute(this.config.fewAttr);t?s||(this.timerNode.setAttribute(this.config.fewAttr,""),this.options.setFewColor&&this.timerNode.style.setProperty("color",this.options.fewColor)):(this.timerNode.removeAttribute(this.config.fewAttr),this.options.setFewColor&&this.timerNode.style.removeProperty("color"))}this.options.saveStateInStorage&&this.timerSeconds>=0&&window?.localStorage?.setItem(this.config.storageKey,String(this.timerSeconds))}validateOptions(t){const s={seconds:{nullable:!1,validator:[typeof t.seconds!="number",t.seconds<=0]},few:{nullable:!0,validator:[t.few!==null&&typeof t.few!="number",typeof t.few=="number"&&t.few<0,typeof t.few=="number"&&t.few>=t.seconds]},fewColor:{nullable:!0,validator:[t.fewColor!==null&&typeof t.fewColor!="string",typeof t.fewColor=="string"&&t.fewColor.length===0]},redirectUrl:{nullable:!0,validator:[t.redirectUrl!==null&&typeof t.redirectUrl!="string",typeof t.redirectUrl=="string"&&t.redirectUrl?.length===0]}};for(const r in s)if(s[r].validator.some(Boolean))throw new TypeError(`Invalid argument for the "${r}" option was passed`);return t}drawPlaceholder(){const{displayMilliseconds:t,fractionDigits:s}=this.options,r=t?"."+"0".repeat(s):"";this.timerNode.innerText="00:00:00"+r}}class c{timer=null;initialize(){const t=document.querySelector("#timer-controls"),s=t?.querySelector('input[type="button"][data-play]'),r=t?.querySelector('input[type="button"][data-stop]'),e=t?.querySelector('input[type="button"][data-pause]'),i=t?.querySelector('input[type="button"][data-reset]'),o=new l("#timer",{few:30,seconds:90,fewColor:"red",setFewColor:!0,bounce:!1,redirect:!1,redirectUrl:null,saveStateInStorage:!1,displayMilliseconds:!0,fractionDigits:2,autoPlay:!1});o.addEventListener("stop",()=>{console.log("Таймер успешно остановлен")}),o.initialize(),s?.addEventListener("click",o.play.bind(o)),r?.addEventListener("click",o.stop.bind(o)),e?.addEventListener("click",o.pause.bind(o)),i?.addEventListener("click",o.reset.bind(o))}}document.addEventListener("DOMContentLoaded",()=>{new c().initialize()});
